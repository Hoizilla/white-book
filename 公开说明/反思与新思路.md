春天到了，流言蜚语也醒了过来，肆虐在TG圈……咳咳扯远了

这次我倒是不是很想说太多我们本身，或者说回应于“网信办”和CNBLR项目本身关系的问题。
但请别急着就此离开：在经过（一年）这段时间的成长，撞了不少墙，也苦恼了很久。我们发现了许多在当前实行中机制存在的问题，以及，我们觉得目前比较可靠的方式，对隐私的诉求以及真实人类封锁等情况进行改善。

## 广告规则和订阅

> 如果你还没有看过上则公告，我们建议你先[点此阅读](./这个项目到底是做什么的-2018-02-14.md)

我们在上则公告内说明，我们的行为类似于广告过滤插件。
如果你用过`Adblock`, `ublock`或者类似的浏览器插件，这些软件除了会有自带推荐订阅的广告过滤规则，你还可以可以**自定义规则**，或者是**自己添加可信的广告规则源**

而目前我们遇到最多的问题就是：为什么机器人无缘无故删除我的消息？难道我的消息是敏感消息？你们是不是和网信办有关系所以要清理TG的消息？

### 广告/机器人：他们怎么出牌

首先，我们要承认一点，目前我们确实是有在我们的服务器上运行`OCR`（图片内容转文字），用于过滤带有微信二维码，图片内含关键词的广告消息。
比如目前比较流行的`电报拉人加微信`，虚拟货币之类的宣传。主要原因是越来越多的广告开始采用如下模式：

- 大批量加群，不发消息，或者是发符合规范的消息"装作是人类"，以保留在群内
- 等待时间到凌晨，管理员或者在线人数较少的时候
- 大批量发送消息，并采用图片，短链接等方式规避传统的封锁方式

如果需要自动化处理这种广告会使得信息处理计算量暴增，而且导致本身是无状态的消息处理机制变得状态化：

- 追踪一个用户加群后第1~10个消息，通常是广告的重灾区。对于机器人来说，我们需要在每条消息到来时查询用户状态（新人并加群+图文链接=高危行为）
- 图片OCR消耗
- 关键词列表越来越长，单消息极端时处理时间~30s

对于一个非盈利的项目，尽管我们已经做了很多细节优化，但是计算量依然超出可以接受的范围。

**而且对于推广工作室而言，每个账号本身的预期寿命就只是在发完单个推广消息**，这导致我们目前基于用户ID追踪的机制几乎失效：每次发完就删号，没有任何成本，甚至来说，他们可以分配安插虚假用户<sup>*</sup>到群内，分批爆发，一次管理员也只能清理一部分，完全没有任何效率可言。

> *辅助阅读：为什么用户相比于机器人，更适合用户监控群内消息？[点击这里](https://github.com/NeverBehave/Telegram-recorder)

## 重新思考：分布式，信任授权，全开放

目前我们遇到的问题归纳一下：

- 计算量巨大
- 被质疑有没有权力判断用户是否为广告/机器人用户
- 处理过程不透明，机器人删除消息机制不确定，暗箱操作

对于以上问题，目前我们给出来的答案是：

- 自部署
- 规则订阅
- 用户信誉机制

我们之前说我们像是浏览器上的广告过滤插件，但是我们同时又做的太多了：我们没有给到用户，**在这里特指群主和管理员**，去选择到底这个用户是不是他们想删的。而且，算力本身应该是由用户本身承担。开源可自部署的机器人并由群主/管理员本身搭建，机器人暗箱/信任危机解决。

### 特性
#### 自部署

- [ ] 黑/白名单用户
- [ ] 新用户验证码
- [ ] 关键词自定义
- [暂不计划支持] 行为判定/OCR 

#### 规则订阅
- [ ] 可选
- [ ] 格式开放，无门槛

**但是**，由于telegram机制更新，转发信息可以不再包含用户信息，订阅机制会导致同步广告/黑名单用户再度推迟，目前问题较多的爆发式广告在该解决方案情况只会恶化

#### 用户信誉机制

#### 为什么，干什么的？

我们注意到市面上涌现了大批量类似的项目，分别维护着不同的规则，且互不联通。我们希望在这里能够建立起一个桥梁，在分布式部署且当事项目/群组管理的情况下，收集广告样本用于更新规则和用户黑/白名单。

#### 等等？白名单？

我们发现审查员的机制/评分机制并不能有效的防止误封锁的情况。~~人类就是主观的~~

> 我们希望 CNBlackListR 更像是一个**档案室**, 在这里，我们会汇总记录来自群组对于一个用户的反馈并提供**参考信息**给到其他群主方便管理。 
>  --- 摘自[这个项目到底是做什么的-2018-02-14.md](https://github.com/CNBlackListR/white-book/find/master)

回归初心，目前规则订阅的目标就是：给定任意用户ID，获得其近期**行为**

给个例子：用户A加入的B群

如果有加入项目的机器人，且开启了遥感。我们会在数据库内记录类似信息：

```
A: { action: "join_group", time:..}
```

默认仅记录操作和时间（因为至少目前来说，甄别广告很多时候会用到操作时间，如果你有更好的主意，欢迎开Issue讨论），以及任何群主/管理员希望上报的消息（比如消息本身是广告，etc），然后提供一个公开的地方进行查询

对于任何一个希望利用这个信息来进行垃圾用户清理的用户，可以**自行进行打分**。比如说
```
 15分钟内加群个数*10 + 15分钟内发送图片次数*1 > 100 的为高危用户
```
这些规则不由我们来定义，因为我们确实没有权力来定义你的群组希望怎么样的人。**我们只希望能够提供给你足够的信息来判断这个人是否应该在你的群里**

我们同时希望借此机会让更多人来尝试参与规则定制，一同出力和反击这个扰乱生态圈的推广行业。

> 当你在凝视深渊的时候，深渊也在凝视你


### 现状

实话实说，没钱人和拿钱的人打架，吃力不讨好。

1. 现有机器人

现有机器人将会逐步转移进Beta测试，即会实施最新最即时的垃圾消息机制。**这个版本将不会或仅开放少量定制功能**

我们在准备完可独立部署版本后便会在每个群内询问是否需要继续保留

2. 信任平台构建*

当前核心项目，第一阶段架构正在进行中

如果你的垃圾清理项目有意向分享数据，请给我们[开个Issue说明](/../../issues)，万分感激



### FAQ

#### 为什么一直在强调管理员和群主？

因为在TG里面，管理员和群主其实就相当于他们群里面的“皇帝“。他们给予各种权限到人/机器人以方便他们完成自己，或者是别人的诉求。

#### 我还是信不过你这个垃圾项目，就是网信办/共产党派来清敏感消息的，傻逼

:) 那你不然人力手清……不然你试试付钱的方案？谷歌一搜一大把，都是商业闭源，当然也有免费的。~~说不定是网信办开的公司？~~
